from urllib.request import urlopen


def check(url):
    ''' check given URL is vulnerable or not '''

    try:
        if "http" not in url:
            url = "http://" + url

        data = urlopen(url)
        headers = data.info()

        if not "X-Frame-Options" in headers:
            return url

    except:
        return False


def create_poc(url):
    ''' create HTML page of given URL '''

    code = """
            <html>
               <head><title>Clickjack test page</title></head>
               <body>
                 <p>Website is vulnerable to clickjacking!</p>
                 <iframe src="{}" width="500" height="500"></iframe>
               </body>
            </html>
                """.format(url)
    try:
        with open("output/clickjack/poc.html", "w+") as f:
            f.write(code)
            f.close()
            return True
    except:
        return False


def checkClick(domain):

    status = check(domain)
    if status:
        return create_poc(status)
    else:
        with open("output/clickjack/poc.html", "w+") as f:
            f.write("Website is not vulnerable")
            f.close()
            return True


# checkClick('fipi.org.in')
