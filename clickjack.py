from urllib.request import urlopen
__author__ = 'sickwiz'


def check(url):
    ''' check given URL is vulnerable or not '''

    try:
        if "http" not in url:
            url = "http://" + url

        data = urlopen(url)
        headers = data.info()

        if not "X-Frame-Options" in headers:
            return url

    except:
        return False


def create_poc(url):
    ''' create HTML page of given URL '''

    code = """
            <html>
               <head><title>Clickjack test page</title></head>
               <body>
                 <p>Website is vulnerable to clickjacking!</p>
                 <iframe src="{}" width="500" height="500"></iframe>
               </body>
            </html>
                """.format(url)
    with open("poc.html", "w") as f:
        f.write(code)
        f.close()


def checkClick(domain):

    status = check(domain)
    if status:
        create_poc(status)
        return "Website is vulnerable. PoC saved at poc.html"
    else:
        return " [-] Website is not vulnerable!"


# checkClick('fipi.org.in')
