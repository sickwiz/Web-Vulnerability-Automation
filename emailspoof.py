try:
    import time
    from sys import __stdout__, stdout
    from threading import Thread
    from subprocess import *
    import os
    import sys
    import subprocess
    import threading
    import readline
    from termcolor import colored
    from flask import jsonify
except ImportError:
    print("\ncheck for prerequisities ")


def emailspoof_ZT(target):

    os.system('clear')
    p = './osint/'
    try:
        os.mkdir(p)

    except FileExistsError as exc:
        print(exc)
    dnsrecon = "~/Tools/dnsrecon/dnsrecon.py"
    print(colored("\n--------------------------------------------",
                  'red', attrs=['bold']))
    print(
        colored("[+] Start collecting information about target", 'red', attrs=['bold']))
    print(colored("--------------------------------------------",
                  'red', attrs=['bold']))
    print(colored("\n[*]\tRunning DNSRECON\n[*]", 'red', attrs=['bold']))
    # global fileObject
    cmd = [
        "python3 "+dnsrecon+" -d "+target+" -a -j osint/zt.json",
        "cat osint/zt.json | tee osint/Spoof_zonetransfer.txt"
    ]
    try:

        for c in cmd:
            proc = subprocess.run(c, shell=True, stderr=STDOUT, stdout=PIPE)
            print(c)
        if(proc.returncode != 0):
            print(colored('Step 1 Failed! Check/Update prerequisitie packages. \nError: ',
                          'blue', attrs=['bold']) + proc.stderr.rstrip())
            sys.exit(1)
        else:
            subprocess.run(
                'rm  osint/zt.json', shell=True, stdout=PIPE)
            print(colored("[x] Executed", 'blue', attrs=['bold']))
    except:
        print("Something went wrong! Check prerequisities.\n")
    scanResult = []
    with open('osint/Spoof_zonetransfer.txt') as result:
        scanResult = result.readlines()
    try:
        subprocess.run('rm osint/*.txt', shell=True, stdout=PIPE)
    except:
        pass
    return jsonify(scanResult)
