from flask import Flask, render_template, request, make_response
import pdfkit
import os
app = Flask(__name__)


@app.route('/')
def home():
    return render_template("index.html")

# wayback


@app.route('/wayback', methods=["GET", "POST"])
def wayBack():
    import wayback
    from wayback import waybackMachine
    domain = request.form['domain']
    res = waybackMachine(domain)
    return render_template("wayback.html", pO=res)


@app.route('/s3', methods=["GET", "POST"])
def xss():
    import s3buckets
    from s3buckets import bucketfinder
    url = request.form['company']
    result = bucketfinder(url)
    return render_template("s3.html", le=len(result), ur=url, bucket=result)


@app.route('/click', methods=["POST"])
def jacking():
    import clickjack
    from clickjack import checkClick
    domain = request.form['domain']
    res = checkClick(domain)
    return render_template("clickjack.html", pO=res)


@app.route('/hsts', methods=["POST"])
def hsts():
    import hsts
    from hsts import checkHSTS
    domain = request.form['domain']
    res = checkHSTS(domain)
    return render_template("clickjack.html", pO=res)


@app.route('/subdomain', methods=["POST"])
def subs():
    import subdomain
    from subdomain import findDomain
    domain = request.form['domain']
    res = findDomain(domain)
    return render_template("subdomain.html", le=len(res), subs=res)


app.run(debug=True)
